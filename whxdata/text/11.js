rh._.exports({"0":[["n_ethr"]],"1":[[" ","1    ","Configuring Ethernet Ports","The Ethernet software is responsible for a variety of functions that support Ethernet ports on OmniSwitch Series switches. These functions include diagnostics, software loading, initialization, configuration of line parameters, gathering statistics, and responding to administrative requests from SNMP or CLI.","In This Chapter","This chapter describes the Ethernet port parameters of the switch and how to configure them through the Command Line Interface (CLI). CLI Commands are used in the configuration examples. ","Configuration procedures described in this chapter include:","•    ","“Configuring Ethernet Port Parameters” on page 1-3","•    ","“Using TDR Cable Diagnostics” on page 1-12","•    ","“Interfaces Violation Recovery” on page 1-14","•    ","“Clearing Ethernet Port Violations” on page 1-18","•    ","“Link Monitoring” on page 1-19","•    ","“Link Fault Propagation” on page 1-23","•    ","“IEEE 1588 Precision Time Protocol (PTP)” on page 1-26","•    ","“MAC Security Overview” on page 1-28","For more information about using CLI commands to view Ethernet port parameters, see the ","OmniSwitch AOS Release 8 CLI Reference Guide",".","Ethernet Port D","efau","lts","The following table shows Ethernet port default values: ","Parameter Description","Command","Default Value/Comments","Interface Line Speed","interfaces speed","AutoNeg","Interface Duplex Mode","interfaces duplex","AutoNeg","Trap Port Link Messages","interfaces link-trap","Disabled","Interface Configuration","interfaces","Enabled","Peak Flood Rate Configuration","interfaces flood-limit","4 Mbps (10M Ethernet)","49 Mbps (100M Ethernet)","496 Mbps (1G Ethernet)","700 Mbps (2.5G Ethernet)","997 Mbps (10G Ethernet)","997 Mbps (40G Ethernet)","997 Mbps (100G Ethernet)","Interface Alias","interfaces alias","None configured","Maximum Frame Size","interfaces max-frame-size","1553 (untagged) Ethernet packets","1553 (tagged) Ethernet packets","9216 Gigabit Ethernet packets","Digital Diagnostics Monitoring (DDM)","interfaces ddm","Disabled","Enhanced Port Performance (EPP)","interfaces","Disabled","Beacon LED","interfaces beacon","Disabled","Precision Time Protocol (PTP) time stamping on the switch","interfaces ptp admin-state","Disabled","E","thernet Ports Overview","This chapter describes the Ethernet software CLI commands used for configuring and monitoring the Ethernet port parameters of your switch. ","Configuring Ethernet Port Parameters ","The following sections describe how to use CLI commands to configure ","ethernet ports. ","Enabling and Disabling Autonegotiation","To enable or disable autonegotiation on a single port, a range of ports, or an entire slot, use the ","interfaces"," ","command. For example: ","-> interfaces 2/3 autoneg enable","-> interfaces 2/1-3 autoneg enable","-> interfaces 2 autoneg enable","Configuring Crossover Settings","To configure crossover settings on a single port, a range of ports, or an entire slot, use the ","interfaces crossover"," ","command. If autonegotiation is disabled, auto MDIX, auto speed, and auto duplex are not accepted.","Setting the crossover configuration to ","auto"," configures the interface or interfaces to automatically detect crossover settings. Setting crossover configuration to ","mdix"," configures the interface or interfaces for MDIX (Media Dependent Interface with Crossover), which is the standard for hubs and switches. Setting crossover to ","mdi"," configures the interface or interfaces for MDI (Media Dependent Interface), which is the standard for end stations.","For example:","-> interfaces 2/1 crossover auto","-> interfaces 2/2-5 crossover mdi","-> interfaces 3 crossover mdix","Setting Interface Line Spee","d","The ","interfaces speed"," comman","d is used to set the line speed on a specific port, a range of ports, or all ports on an entire slot. ","For example:","-> interfaces 2/1 speed 100","-> interfaces 2/2-5 speed 1000","-> interfaces 3 speed auto","Configuring Duplex Mode","The ","interfaces duplex"," comman","d is used to configure the duplex mode on a specific port, a range of ports, or all ports on a slot to ","full, ","half, or ","auto",". (The ","auto ","option causes the switch to advertise all available duplex modes (half/full/both) for the port during autonegotiation.) In full duplex mode, the interface transmits and receives data simultaneously. In half duplex mode, the interface can only transmit or receive data at a given time.","For example:","-> interfaces 2/1 duplex half","-> interfaces 2/2-5 duplex auto","-> interfaces 3 duplex full","S","etting Trap Port Link Messa","ges","The ","interfaces link-trap"," comman","d can be used to enable or disable trap port link messages on a specific port, a range of ports, or all ports on a slot. When enabled, a trap message is sent to a Network Management Station (NMS) whenever the port state has changed. ","For example:","-> interfaces 2/3 link-trap enable","-> interfaces 2/3-5 link-trap enable","-> interfaces 2 link-trap enable","R","esetting Statistics Counters","The ","clear interfaces"," ","comma","nd is used to reset all Layer 2 statist","ics counters on a specific port, a range of ports, or all ports on a slot. For example:","-> clear interfaces 2/3 l2-statistics","-> clear interfaces 2/1-3 l2-statistics","-> clear interfaces 2 l2-statistics","This command also includes an optional ","cli"," parameter. When this parameter is specified, only those statistics that are maintained by the switch CLI are cleared; SNMP values are not cleared and continue to maintain cumulative totals. For example:","-> clear interfaces 2/1-3 l2-statistics cli","Note that when the ","cli"," parameter is not specified both CLI and SNMP statistics are cleared.","Enabling and Disabling Interfaces","The ","interfaces"," ","comman","d is used to enable or disable a specific port, a range of ports, or all ports on an entire slot. ","-> interfaces 2/3 admin-state disable","-> interfaces 2/1-3 admin-state disable","-> interfaces 2 admin-state disable","Configuring a Port Alias","The ","interfaces alias"," ","command is used to configure an alias (i.e., description) for a single port. (You cannot configure an entire switch or a range of ports.) For example: ","-> interfaces 2/3 alias ip_phone1","-> interfaces 2/3 alias “ip phones 1”","Note.  ","Spaces must be contained within quotes.","Configuring Maximum Fram","e Sizes","The ","interfaces max-frame-size"," ","comman","d can be used to configure the maximum frame size (in bytes) on a specific port, a range of ports, or all ports on a switch. ","For example:","-> interfaces 2/3 max frame 9216","-> interfaces 2/1-3 max frame 9216","-> interfaces 2 max frame 9216","Configuring Digital Diagnostic Monitoring (DDM)","Digital Diagnostics Monitoring allows the switch to monitor the status of a transceiver by reading the information contained on the transceiver's EEPROM. The transceiver can display Actual, Warning-Low, Warning-High, Alarm-Low and Alarm-High for the following:  ","•    ","Temperature ","•    ","Supply Voltage","•    ","Current ","•    ","Output Power ","•    ","Input Power ","To enable the DDM capability on the switch use the ","interfaces ddm"," command. For example, enter:","-> interfaces ddm enable","Traps can be enabled using the ","interfaces ddm-trap"," if any of the above values crosses the pre-defined low or high thresholds of the transceiver. For example: ","-> interfaces ddm-trap enable","Note.  ","In order to take advantage of the DDM capability, the transceiver must support the DDM functionality. Not all transceivers support DDM; refer to the Transceivers Guide for additional DDM information.","Configuring Flood Ra","te Limiting","The ","OmniSwitch"," implementation of storm control supports flood rate limiting for broadcast, unknown unicast, and multicast traffic. A high threshold rate is configured in megabits-per-second (mbps), packets-per-second (pps), or as a percentage of the port speed. When the threshold value is reached, packets are dropped.","To configure the flood rate limit threshold, use the ","interfaces flood-limit"," ","comman","d For example:","-> interfaces 2/1/1 flood-limit bcast rate mbps 100","-> interfaces 2/1/2-5 flood-limit uucast rate pps 500","-> interfaces slot 3/1 flood-limit mcast rate cap% 50","Configuring a Flood Rate Limit Action","Configuring a port shutdown or trap action to occur when the rate limit threshold is reached provides a method for monitoring storm traffic. ","•    ","Port shutdown action—port is moved to a STORM violated state and a violation trap is sent.","•    ","Trap action—the storm is controlled through flood rate limiting and a trap is sent. The port is not moved into a STORM violated state.","To configure the flood rate limit action, use the ","interfaces flood-limit action"," command with either the ","shutdown"," or ","trap"," option. For example:","-> interfaces 1/1/1 flood-limit bcast action shutdown","-> interfaces 1/1/4 flood-limit uucast action trap","Use the ","all"," option with the ","interfaces flood-limit action"," command to specify all types of traffic. For example:","-> interfaces 1/1/11 flood-limit all action shutdown","To set the flood rate limit action back to the default value (no action is taken, packets above the threshold are dropped) use the ","interfaces flood-limit action"," command with the ","default"," option. For example:","-> interfaces 1/1/14 flood-limit mcast action default","Configuring Auto-Recovery for Port Shutdown Action","When a port is shutdown because of a STORM violated state, an administrator will have to clear the violation. However, configuring a low threshold value for flood rate limiting can help to automate this process. When the rate of violating traffic received on the port goes below the low threshold value, the port is removed from the violating state.","To configure the low threshold value, use the ","interfaces flood-limit"," command with the ","low-threshold"," option. For example:","-> interfaces 1/1/1 flood-limit bcast rate mbps 60 low-threshold 40","-> interfaces 1/1/4 flood-limit uucast rate mbps 100 low-threshold 40","-> interfaces 1/1/5 flood-limit mcast rate pps 2000 low-threshold 1000","Configuring Flow Control","The ","interfaces pause"," comma","nd is used to configure flow control (pause) settings for ports that run in full duplex mode. Configuring flow control is done to specify whether or not an interface transmits, honors, or both transmits and honors PAUSE frames. PAUSE frames are used to temporarily pause the flow of traffic between two connected devices to help prevent packet loss when traffic congestion occurs between switches.","Note that if autonegotiation and flow control are both enabled for an interface, then autonegotiation determines how the interface processes PAUSE frames. If autonegotiation is disabled but flow control is enabled, then the configured flow control settings apply.","By default, flow control is disabled. To configure flow control for one or more ports, use the ","interfaces pause"," comma","nd with one of the following parameters to specify how PAUSE frames are processed:","•    ","tx—","Transmit PAUSE frames to peer switches when traffic congestion occurs on the local interface. Do not honor PAUSE frames from peer switches. ","•    ","rx—","Allow the interface to honor PAUSE frames from peer switches and temporarily stop sending traffic to the peer. Do not transmit PAUSE frames to peer switches.","•    ","tx-and-rx—","Transmit and honor PAUSE frames when traffic congestion occurs between peer switches.","For example, the following command configures ports 1/1 through 1/10 to transmit and honor PAUSE frames:","-> interfaces 1/1-10 pause tx-and-rx","To disable flow control for one or more ports, specify the ","disable"," parameter with the ","interfaces pause"," command. For example:","-> interfaces 1/10 pause disable","Enabling and Disabling Enhanced Port Performance (EPP)","EPP can assist in connecting with SFF-8431 non-compliant or electrically deficient devices. EPP can be used on some links to enhance the receive signal sampling resolution management and help to improve the link integrity to the link partner. The following steps should be followed to determine if EPP should be enabled:","1    ","Check the current link quality"," - Check the current link quality of the interface.","2    ","Diagnose any link quality issues"," - If the Link Quality is not ‘","Good","’. Perform a few basic troubleshooting steps to determine if the issue is with the link partner and whether enabling EPP can help improve the quality.","3    ","Enable EPP"," - If it’s determined that the issue is with the link parter, enable EPP. ","EPP - Product and Transceiver Support","Only certain transceivers support enabling EPP. Additionally, depending on the revision of the OmniSwitch, there are port restrictions due to the power requirements of enabling EPP as shown in the table below. ","Product","Rev","EPP Support","OS6900-X20","B11","B10 or less","No restriction","Only 5 ports can have EPP enabled","OS6900-X40","B11","B10 or less","No restriction","Only 5 ports in 1st group of 20 and 5 ports in 2nd group of 20","Expansion Board","Any","No restrictions","10-Gigabit Transceivers","N/A","Supported","1/40-Gigabit Transceivers","N/A","Not Supported","Product/Transceiver Support","EPP - Check the Current Link Quality","A Link-Quality parameter has been added to help support EPP functionality. If connectivity issues are being observed check the current link quality using the ","interfaces"," command and observe the EPP output. For example: ","-> show interfaces 2/1","(","output truncated",")","EPP                    : Disabled,   Link-Quality:Fair","Link-Quality","Description","Good","Link is good","Fair","Link may exhibit errors","Poor","Link will exhibit errors and may lose connectivity","N/A","Link does not support EPP","EPP - Diagnose","For ports diagnosed as ","Fair"," or ","Poor",", simple steps can be performed to identify the faulty component. Since the issue could be with the transceiver, cable, fiber, or the link partner, see the table below to help determine if the issue is with the link partner and if enabling EPP may help.","Media Type","Diagnostic Action","Direct Attached Copper Cable","•    ","Disconnect cable from link partner","•    ","Connect free cable end to unused port of OS6900","•    ","View the Link-Quality","Good"," - The link partner should be diagnosed and enabling EPP may help.","Fair"," or ","Poor"," - The direct-attached copper cable should be replaced.","SFP+ optical transceiver","•    ","Replace SFP+ transceiver on OS6900 port","•    ","View the Link-Quality","Good"," - The original SFP+ transceiver is faulty.","Fair"," or ","Poor"," - The fiber cable or link partner should be diagnosed and enabling EPP may help.","EPP - Enabling","If after diagnosing the problem it is determined that the issue is with the link partner and the Link-Quality has been diagnosed to be ","Fair ","or"," Poor, ","EPP can be enabled allowing the system to operate with the deficient receive channels. For example: ","-> interfaces 2/1 epp enable","After enabling EPP continue to monitor the Link-Quality. ","Configuring Energy Efficient Ethernet (802.3az)","Energy Efficient Ethernet (EEE) is a protocol to allow ports to operate in idle or low power mode when there is no traffic to send. When EEE is enabled on a port it will advertise its EEE capability to its link partner. If the partner supports EEE they will operate in EEE mode. If the partner does not support EEE the ports will operate in legacy mode. This allows EEE capable switches to be deployed in existing networks avoiding backward compatibility issues. ","•    ","EEE is only applicable to 10GBase-T ports. ","•    ","The LLDP option in IEEE 802.3az standard is not currently supported.","To enable the EEE capability on the switch use the ","interfaces eee"," command. For example, enter:","-> interfaces 1/1 eee enable","Configuring Split-Mode","Some OmniSwitch models support split-mode to allow 40G or 100G ports to be configured as four 10G or 25G ports. The ","interfaces primary-port split-mode"," command is used to configure the mode.","When a splitter cable is used the port numbering scheme changes to accommodate the four splitter ports by using letters a, b, c, d to refer to the sub-ports. When referring to a single sub-port the port letter should be used to differentiate between all the sub-ports. If no letter is given the command assumes port 'a', for example. ","-> show interfaces 1/1/1 - refers to interface 1/1/1a","-> show interfaces 1/1/1a - refers to interface 1/1/1a","-> show interfaces 1/1/1d - refers to interface 1/1/1d","When referring to a range of ports the lettered sub-ports are implied, for example:","-> show interfaces 1/1/1-2 - refers to interfaces 1/1/1a, 1b, 1c, 1d and 1/1/2a, 2b, 2c, 2d","-> show interfaces 1/1/1a-1c - refers to interfaces 1/1/1a, 1b, 1c","-> show interfaces 1/1/1-2a - refers to interfaces 1/1/1a, 1b, 1c, 1d, and 1/1/2a.","Configuring Beacon LED","The Beacon LED feature provides a mechanism to allow an administrator to configure the color and the mode of a port LED using the ","interfaces beacon"," command. This can useful in the following scenarios:","•    ","Port identification: Can help to identify a particular port(s) needing attention or where a cable may need to be swapped. Manually changing the color or mode of the port LED can help to guide a technician to a particular port. This can also be helpful in a highly dense mesh of cabling.","•    ","Power Savings: Large Data Centers are looking for ways to reduce power consumption. One way could be to power off every LED on every node if operating properly and only use the LEDs for indicating ports that need attention.","•    ","Tracking link activity: Servers are often configured in clusters for certain functions or applications. Ports could be color coded to differentiate between clusters.","Note.  ","The beacon LED feature does not affect the normal behavior of switch ports or traffic flow. It only sets LED colors and behaviors for the uses listed above. If an actual alarm or issue is detected on the switch, important LED status information related to the issue takes precedence and overrides beacon settings.","Note.  ","The beacon LED feature is not supported on sub-ports 'b', 'c', or 'd' when an interface is operating in split-mode. Additionally, only Solid mode is supported on sub-port 'a' interfaces. ","LED Color and Mode Settings","•    ","LED Color - The color of the LED can be changed to yellow, white, red, magenta, green, blue, aqua, or off. ","•    ","Activity Mode - The LED will blink normally based on the port activity but the color of the LED can be changed.","•    ","Solid Mode - The LED will not blink based on the port activity, it will always be solid. The color of the LED can be changed.","-> interfaces 1/1/30 beacon admin-status enable","-> interfaces 1/1/30 beacon led-color magenta","-> interfaces 1/1/30 beacon led-mode solid","Beacon settings are saved and can be administratively enabled or disabled as needed at a later time. This allows administrators to reuse previously configured LED settings without having to start over. Use the ","show interfaces beacon"," command to view the beacon settings.","-> show interfaces beacon"," Ch/Slot/Port   Admin-Stat   LED-Color    LED-Mode","------------+-------------+--------------+------------"," 1/1/1A          Disable     Magenta      Solid"," 1/1/2A          Disable     Blue         Activity"," 1/1/30A         Enable      Magenta      Solid"," 1/1/31A         Enable      Off          Solid","Using TDR Cable Diagnostics","Time Domain Reflectometry (TDR) is a feature that is used to detect cable faults. This feature is best deployed in networks where service providers and system administrators want to quickly diagnose the state of a cable during outages, before proceeding with further diagnosis.","When a TDR test is initiated, a signal is sent down a cable to determine the distance to a break or other discontinuity in the cable path. The length of time it takes for the signal to reach the break and return is used to estimate the distance to the discontinuity.","Initiating a TDR Cable Diagnostics Test","Consider the following guidelines before initiating a TDR test:","•    ","Only one test can run at any given time, and there is no way to stop a test once it has started.","•    ","The TDR test runs an “out-of-service” test; other data and protocol traffic on the port is interrupted when the test is active.","•    ","TDR is supported only on copper ports. ","•    ","TDR is not supported on Link aggregate ports.","•    ","Each time a TDR test is run, statistics from a test previously run on the same port are cleared.","A TDR test is initiated using the ","interfaces tdr"," ","CLI command. For example, the following command starts the test on port 2/1:","-> interfaces 1/1/1 tdr enable","Displaying TDR Test Results","The ","show interfaces tdr-statistics"," command is used to display TDR test statistics. For example:","-> show interfaces 1/1/1 tdr-statistics","Ch/","Slot/ No of Cable Fuzzy  Pair1 Pair1  Pair2 Pair2  Pair3 Pair3  Pair4 Pair4  Test","Port pairs  State Length State Length State Length State Length State Length Result","-----+-----+------+-----+-----+-----+------+------+-----+------+-----+------+------","1/1/1     4     ok     0    ok    3     ok      3     ok     3     ok    3     success","The following cable states are indicated in the ","show interfaces tdr-statistics ","command"," ","output:","•    ","OK","—Wire is working properly","•    ","Open",":—Wire is broken","•    ","Short","—Pairs of wire are in contact with each other","•    ","Crosstalk","—Signal transmitted on one pair of wire creates an undesired effect in another wire.","•    ","Unknown",":—Cable diagnostic test unable to find the state of a cable.","Clearing TDR Test Statistics","The ","clear interfaces"," command is used to clear the statistics of the last test performed on the port. There is no global statistics clear command. For example, the following command clears the TDR statistics:","-> clear interfaces 1/1/1 tdr-statistics","TDR statistics from a previous test are also cleared when a new test starts on the same port.","Interfaces Violation Recovery","The OmniSwitch allows features to shutdown an interface when a violation occurs on that interface. To support this functionality, the following interfaces violation recovery mechanisms are provided:","•    ","Manual recovery of a downed interface using the ","interfaces primary-port split-mode"," command.","•    ","An automatic recovery timer that indicates how much time a port remains shut down before the switch automatically brings the port back up (see ","“Configuring the Violation Recovery Time” on page 1-16",").","•    ","A maximum number of recovery attempts setting that specifies how many recoveries can occur before a port is permanently shutdown (see ","“Configuring the Violation Recovery Time” on page 1-16",").","•    ","A wait-to-restore timer that indicates the amount of time the switch waits to notify features that the port is back up (see ","“Configuring the Wait-to-Restore Timer” on page 1-20",").","•    ","An SNMP trap that is generated each time an interface is shutdown by a feature. This can occur even when the interface is already shutdown by another feature. The trap also indicates the reason for the violation.","•    ","An SNMP trap that is generated when a port is recovered. The trap also includes information about how the port was recovered. Enabling or disabling this type of trap is allowed using the ","violation recovery-trap"," command.","Violation Shutdown and Recovery Methods","A port can be shutdown with one of the following methods, depending on the feature. ","Filtering"," – The port is blocked by applying filtering to discard all packets sent or received on the port. With this method the link LED of the port remains ON. A port in this state can be recovered using the following methods:","•    ","Using the ","interfaces primary-port split-mode"," command to manually clear the violation.","•    ","Automatic recovery when the interface recovery timer expires.","•    ","Using the ","interfaces alias"," command to administratively disable and enable the interface. ","•    ","   Disconnecting and reconnecting the interface link. ","•    ","A link down and link up event.","Administratively"," – A port is administratively disabled. With this method the LED does not remain ON. A port in this state can be recovered using only the following methods:","•    ","Using the ","interfaces primary-port split-mode"," command to manually clear the violation.","•    ","Automatic recovery when the interface recovery timer expires.","•    ","Using the ","interfaces alias"," command to administratively disable and enable the interface. ","Disconnecting/reconnecting the interface link or a link down/up event ","will not"," recover a port that was administratively disabled.","Interface Violation Exceptions","An interface violation is not applied to an interface when any of the following scenarios occur:","•    ","An interface is already in a permanent shutdown state. In this case, the only method for recovery is to use the ","interfaces primary-port split-mode"," command.","•    ","An interface is already shutdown by another feature.","•    ","   An interface is not operationally up.","Interaction With Other Features","The table below lists the features that use the interfaces violation recovery mechanisms, along with the violation reason and shutdown type. ","Feature","Reason Code","Shutdown Type ","BPDU Shutdown","STP","Discard","User Port Shutdown","QOS","Discard","Policy rule - port disable","QOS","Discard","LPS","LPS-D","Discard","LPS","LPS-S","Admin-Down","UDLD","UDLD","Admin-Down","NetSec","NetSec","Admin-Down","NI","NISup","Admin-Down","LLDP Rouge Detection","LLDP","Discard","Link Monitoring","LinkMon","Admin-Down","Link Fault Propagation","LFP","Admin-Down","Remote Fault Propagation","RFP","Admin-Down","Configuring Interface Violation Recovery","The following sections provide information about how to configure parameter values that apply to the interfaces violation recovery mechanisms.","Configuring the Violation Recovery Time","The violation recovery time specifies the amount of time the switch waits before automatically recovering a port that was shut down due to a violation. When the recovery timer expires, the interface is operationally re-enabled and the violation on the interface is cleared. ","Consider the following when configuring the violation recovery time:","•    ","The timer value does not apply to interfaces that are in a permanent shutdown state. A port in this state is only recoverable using the ","clear violation"," command.","•    ","The interface violation recovery mechanism is not supported on link aggregates, but is supported on the link aggregate member ports.","By default, the automatic recovery time is set to 300 seconds. Use the ","violation recovery-time"," ","command to change the automatic recovery time value, which is configurable on a per-port or global basis. For example, the following commands set the violation recovery time to 600 seconds at the global level and to 200 seconds for port 2/1 on chassis 1:","-> violation recovery-time 600","-> violation port 1/2/1 recovery-time 200","The violation recovery time value configured for a specific interface overrides the global value configured for all switch interfaces. To set the port-level value back to the global value, use the ","default"," parameter with the ","violation recovery-time"," command. For example, the following command sets the violation recovery time for port 2/1 on chassis 1 back to the global value of 600:","-> violation port 1/2/1 recovery-time default","Configuring the Violation Recovery Maximum Attempts","The violation recovery maximum setting specifies the maximum number of recovery attempts allowed before a port is permanently shut down. This value increments by one whenever an interface recovers from a violation using the automatic recovery timer mechanism. When the number of recovery attempts exceeds this configured threshold, the interface is permanently shut down. The only way to recover a permanently shut down interface is to use the ","clear violation"," command.","The recovery mechanism tracks the number of recoveries within a fixed time window (FTW). The FTW = 2 * maximum recovery number * recovery timer. For example, if the maximum number of recovery attempts is set to 4 and the recovery timer is set to 5, the FTW is 40 seconds (2 * 4 * 5=40).","The ","violation recovery-maximum"," ","command is used to configure the maximum number of recovery attempts. This value is configurable on a per-port or global basis. For example, the following commands set the number of attempts to 3 at the global level and to 5 for port 2/1on chassis 1:","-> violation recovery-maximum 3","-> violation port 1/2/1 recovery-maximum 5","The maximum recovery attempts value configured for a specific interface overrides the global value configured for all switch interfaces. To set the port-level value back to the global value, use the ","default"," parameter with the ","violation recovery-maximum"," command. For example, the following command sets the number of recovery attempts for port 2/1 on chassis 1 back to the global value of 3:","-> violation port 1/2/1 recovery-maximum default","To disable the violation recovery maximum attempts mechanism, set the number of attempts to zero. For example:","-> violation recovery-maximum 0","-> violation port 1/2/1 recovery-maximum 0","Verifying the Interfaces Violation Recovery Configuration","Use the following ","show"," commands to verify the violation recovery configuration:","show interfaces","Displays the administrative status, link status, violations, recovery time, maximum recovery attempts and the value of the wait-to-restore timer.","show violation","Displays the address violations that occur on ports with LPS restrictions. This command displays a port violation for sticky port security when the maximum number of MAC address of the connected workstation that the switch learns.","show interfaces portgroup","Displays the globally configured recovery time, SNMP recovery trap enable/disable status and maximum recovery attempts.","For more information about the resulting displays from these commands, see the ","OmniSwitch AOS Release 8 CLI Reference Guide",".","Clearing Ethernet Port Violations","The following switch applications may trigger a violation condition on one or more ports:","•    ","Learned Port Security (LPS)","•    ","Quality of Service (QoS)","•    ","Network Security ","•    ","UniDirectional Link Detection (UDLD) ","•    ","Fabric stability related violations","Depending on the application and type of violation, specific actions are taken when a violation is detected on the port. For example, an application may take one of the following actions when the violation triggers a port shut down:","•    ","Admin Down","—deactivates the physical port. ","•    ","Simulated Down","—the physical port shows as active but the applications are not allowed to access the port link. ","The port is put in a blocking state.","A security violation may occur under the following conditions:","•    ","A port is configured as a secure port and the number of secure MAC addresses learned on the port has exceeded the maximum value. ","•    ","A device with a secure MAC address that is configured or learned on one of the secure ports attempts to access another secure port.","Consider the following regarding link aggregate security violations:","•    ","When a violation occurs on a physical port that is a member of a link aggregate, the violation affects the entire link aggregate group. All ports on that link aggregate are either restricted or shut down.","•    ","When the violations are cleared for the entire link aggregate group, the whole link aggregate group is reactivated.","•    ","When a simulated down violation occurs, toggling the link clears the violation for both the link aggregates and physical ports.","To view the violation conditions that exist on individual ports or link aggregates, use the ","show violation"," command. For example:","-> show violation "," Port   Source     Action              Reason           Timer","------+----------+-------------------+----------------+--------","  1/1  src lrn    simulated down      lps shutdown     0","  1/2  src lrn    simulated down      lps restrict     0","‘ ‘ ","2","‘‘","qos","‘ ‘ ‘ ‘"," admin down          policy           0","To clear all the MAC address violation logs and activate the port or link aggregate, use the ","clear violation"," command. For example:","-> clear violation port 1/10 ","-> clear violation linkagg 10-20 ","Link Monitoring","The Link Monitoring feature is used to monitor interface status to minimize the network protocol re-convergence that can occur when an interface becomes unstable. To track the stability of an interface, this feature monitors link errors and link flaps during a configured timeframe. If the number of errors or link flaps exceeds configured thresholds during this time frame, the interface is shut down. ","Note.  ","Link Monitoring ","can be enabled on the member ports of the link aggregate, but not on the entire link aggregate. Link Monitoring is not supported on the VFL ports.","There are no explicit Link Monitoring commands to recover a port from a Link Monitoring shutdown. See ","“Clearing Ethernet Port Violations” on page 1-18"," for information of clearing port violations. ","Monitoring Interface Errors ","When physical errors occur on an interface, control and data traffic is dropped causing unnecessary re-convergence for the network protocol running on the interface. The Link Monitoring feature monitors the physical errors such as CRC, lost frames, error frames and alignment errors. When a configurable number of errors is detected within the duration of a link monitoring window, the interface is shut down. ","To configure the number of errors allowed before the port is shut down, use the ","interfaces link-monitoring link-error-threshold"," command. For example:","-> interfaces 1/1 link-monitoring link-error-threshold 50","In this example, the port is shutdown if the number of link errors exceeds the threshold value of 50 during the link monitoring window timeframe.","Monitoring Interface Flapping","When physical connectivity errors occur on an interface, the interface becomes unstable and causes unnecessary re-convergence for the network protocols running on the interface. The Link Monitoring feature monitors these interface flaps and shuts down the interface when excessive flapping is detected. ","•    ","The shutdown action is a physical port shutdown (the PHY and LED are down). ","•    ","Whenever an interface comes up and it is not an administrative action (admin-up), the link flap counter is incremented.","The ","interfaces link-monitoring link-flap-threshold"," command is used to configure the number of flaps allowed before the interface is shutdown. For example:","-> interfaces 1/1 link-monitoring link-flap-threshold 5","In this example, the port is shutdown if the number of link flaps exceeds the threshold value of five during the link monitoring window timeframe.","Monitoring Window","The Link Monitoring window is a per-port configurable timer that is started whenever link-monitoring is enabled on a port. During this time frame interface receive errors and interface flaps are counted. If either of the values exceeds the configured thresholds the interface is shut down. ","•    ","The timer value can be modified even when the Link Monitoring timer is running and the new value of timer will take effect after the current running timer expires. ","•    ","The threshold values for link errors and link flaps can also be modified when link-monitoring timer is running; if the new threshold value is less than the current link-flap or link-error counter value, then the interface will be shutdown immediately. ","The ","interfaces link-monitoring time-window"," command is used to configure the monitoring window timer. For example:","-> interfaces 1/1 link-monitoring time-window 500","In this example, link monitoring will monitor port 1/1 for 500 seconds.","Starting a Link Monitoring Session","The Link Monitoring window timer is started when the feature is enabled on an interface using the ","interfaces link-monitoring admin-status"," command. For example:","-> interfaces 1/1 link-monitoring admin-status enable ","All the statistics (link errors and link flaps) for a port are reset to zero when Link Monitoring is enabled on that port.","Stopping a Link Monitoring Session","The Link Monitoring window timer is stopped when one of the following occurs:","•    ","The ","interfaces link-monitoring admin-status"," command is used to disable the feature on the port. For example:","-> interfaces 1/1 link-monitoring admin-status enable ","•    ","The port is shutdown by any feature, such as Link Monitoring, UDLD, or Link Fault Propagation.","Configuring the Wait-to-Restore Timer","The wait-to-restore (WTR) timer is used to implement a delay before an interface is made operational for other features. Only after the timer has expired will the interface become active allowing network protocols to converge more gracefully. The timer value is configured on a per-port basis and is started whenever one of the following link-up events occurs: ","•    ","An interface is administratively downed followed by administratively up.","•    ","The ","interfaces primary-port split-mode"," command is used.","•    ","An interface recovers from a violation due to the automatic recovery timer mechanism. ","•    ","An interface is made operationally up when the cable is plugged in. ","Consider the following when configuring the wait-to-restore timer:","•    ","If the interface goes down again while the WTR timer is still running, the WTR timer is stopped. Otherwise, the interface is recovered after the time expires. ","•    ","The WTR timer functionality has no impact on link-error or link-flap detection; these features are configurable even when the WTR timer is disabled. ","•    ","The timer value can be modified when the WTR timer is running; however, the new timer value does not take effect until after the current running timer expires. ","•    ","The WTR timer is reset on every link up event that is detected.","•    ","The WTR timer is stopped on detection of every link down event.","•    ","When the WTR timer is running, the interface is physically up but the link status is down.","The ","interfaces wait-to-restore"," ","command is used to configure the WTR timer value, in multiples of 5. For example, the following commands set the WTR timer value to 300 seconds:","-> interfaces 1/1 wait-to-restore 300","To disable the WTR timer mechanism, set the timer value to zero. For example:","-> interfaces 1/1 wait-to-restore 0","By default, the WTR time is disabled.","Configuring the Wait-to-Shutdown Timer","The wait-to-shutdown (WTS) timer is used to implement a delay before an interface is made non-operational for other applications such as data, control and management. Only after the timer has expired will the interface become disabled allowing network protocols to converge more gracefully. The timer value is configured on a per-port basis and is started whenever one of the following link-up events occurs: ","•    ","An interface is administratively brought down.","•    ","An interface is shutdown from a violation. ","•    ","An interface is made operationally down when the cable is unplugged in.","When the interface goes down, the WTS timer will be started. If the interface comes back up while the WTS timer is running, then WTS timer will be stopped and no link down event will be sent. Otherwise, after the WTS timer expiries a link-down event will be sent to all the relevant applications. ","Consider the following when configuring the wait-to-shutdown timer:","•    ","If the interface comes back up while the WTS timer is still running, the WTS timer is stopped and no link down event is sent to other switch applications. ","•    ","The WTR timer functionality has no impact on link-error or link-flap detection; these features are configurable even when the WTS timer is disabled. ","•    ","The timer value can be modified when the WTS timer is running; however, the new timer value does not take effect until after the current running timer expires. ","•    ","When the wait-to-shutdown timer is running there would be packet loss on that interface. This is because the port is physical down and only the link-down event is not being communicated to the switch applications which will continue to send packets to the interface. ","•    ","The link-status of the remote connected port will be down when the WTS timer is running since the port is physically down. ","The "," ","interfaces wait-to-shutdown"," ","command is used to configure the WTS timer value, in multiples of 10 milliseconds. For example, the following commands set the WTR timer value to 30 seconds:","-> interfaces 1/1 wait-to-shutdown 30000","To disable the WTR timer mechanism, set the timer value to zero. For example:","-> interfaces 1/1 wait-to-shutdown 0","By default, the WTS time is disabled.","Displaying Link Monitoring Information","Use the following ","show"," commands to display Link Monitoring statistics and configuration information:","show interfaces link-monitoring statistics","Displays Link Monitoring statistics, such as the link flap and error counts and the port state (shutdown, down, up).","show interfaces link-monitoring config","Displays the Link Monitoring configuration, such as the monitoring status, monitoring window time, and the link flap and error thresholds.","show interfaces","Displays the administrative status, link status, violations, recovery time, maximum recovery attempts and the value of the wait-to-restore timer.","For more information about the resulting displays from these commands, see the ","OmniSwitch AOS Release 8 CLI Reference Guide",".","Link Fault Propagation","The Link Fault Propagation (LFP) feature provides a mechanism to propagate a local interface failure into another local interface. In many scenarios, a set of ports provide connectivity to the network. If all these ports go down, the connectivity to the network is lost. However, the remote end remains unaware of this loss of connectivity and continues to send traffic that is unable to reach the network. To solve this problem, LFP does the following:","•    ","Monitors a group of interfaces (configured as source ports). ","•    ","If all the source ports in the group go down, LFP waits a configured amount of time then shuts down another set of interfaces (configured as destination ports) that are associated with the same group.","•    ","When any one of the source ports comes back up, all of the destination ports are brought back up and network connectivity is restored.","The LFP source and destination ports can be physical or link aggregation ports. If the destination port is a link aggregation port the shutdown consists of shutting down all members of the link aggregation group (physically down). However, the link aggregation group remains administratively enabled. ","Interaction With Interfaces Violation Recovery","•    ","The ","clear violation"," command will clear the LFP violations and mark the interfaces as up even if the violation condition still exists.","•    ","An admin down followed by an admin up will clear the LFP violation and mark the interfaces as up even if the violation condition still exists.","•    ","When the destination port is a link aggregate, the shutdown action does not shutdown the link aggregation. Instead, all the ports that are members of the link aggregation at the time of the violation are shutdown. ","•    ","A link aggregate port remains in a violation state even if the port leaves the link aggregate.","•    ","If a port that is not a member of a link aggregate at the time a violation occurred is added to a link aggregate, the switch will not shut down the port. ","•    ","SNMP traps cannot be configured for LFP. The interface violation recovery mechanism will be responsible for sending traps when a port is shutdown or recovered by LFP. ","•    ","If the wait-to-restore (WTR) timer is configured on the source ports of a LFP group with link monitoring enabled, the state of the destination ports of the group will be determined by the link state of the ports after the WTR timer has expired. ","See ","“Interfaces Violation Recovery” on page 1-14"," for information of learning port violations.","Configuring Link Fault Propagation","Configuring LFP requires the following steps:","1    ","Create an LFP group",". This type of group identifies the source ports to monitor and the destination ports to bring down when all of the source ports go down. To create an LFP group, use the ","link-fault-propagation group"," command. For example:","-> link-fault-propagation group 1","2    ","Associate source ports with the LFP group",". To associate source ports to an LFP group, use the ","link-fault-propagation group source"," command. For example:","-> link-fault-propagation group 1 source port 1/2-5 2/3","3    ","Associate destination ports with the LFP group",". To associate destination ports with an LFP group, use the ","link-fault-propagation group destination"," command. For example:","-> link-fault-propagation group 1 destination port 1/5-8 2/3","4    ","Configure the LFP wait-to-shutdown timer",". This timer specifies the amount of time that LFP will wait before shutting down all the destination ports. To configure this timer value, use the ","link-fault-propagation group wait-to-shutdown"," command. For example:","-> link-fault-propagation group 1 wait-to-shutdown 70","Note.  ","Optional",". To verify the LFP configuration, use the ","show link-fault-propagation group"," command. For example:","-> show link-fault-propagation group","Group Id : 2","  Source Port(s)          : 0/1-2 1/1-5 1/7,","  Destination Port(s)     : 0/3 1/10-13,","  Group-Src-Ports Status  : up,","  Admin Status            : enable,","  Wait To Shutdown        : 10","Group Id : 6","  Source Port(s)          : 1/2 1/6 1/9,","  Destination Port(s)     : 1/10-11 1/13,","  Group-Src-Ports Status  : down,","  Admin Status            : disable,","  Wait To Shutdown        : 5","-> show link-fault-propagation group 2","Group Id : 2","  Source Port(s)          : 0/1-2 1/1-5 1/7,","  Destination Port(s)     : 0/3 1/10-13,","  Group-Src-Ports Status  : up,","  Admin Status            : enable,","  Wait To Shutdown        : 10","See the ","OmniSwitch AOS Release 8 CLI Reference Guide"," ","for more information about LFP commands.","LFP Application Example","This section provides an example of using LFP in a layer 2 network configuration, as shown in the following sample topology:","Figure 1-1 :  Link Fault Propagation - Application Example","In this example:","•    ","When interfaces 2/1 and 3/1 on OS-1 are down, the access switch will keep interface 1/1 as active and traffic will still be forwarded to OS-1 even though it has no network connectivity. ","•    ","To allow the switch to use the standby interface the link on OS-1 would need to be disabled so that interface 1/1 on the access switch leaves the LACP group. ","-> link-fault-propagation group 1 source port 2/1 3/1 destination linkagg 1","IEEE 1588 Precision Time Protocol (PTP)","The Precision Time Protocol (PTP) is a protocol used to synchronize clocks throughout a computer network. On a local area network, it achieves clock accuracy in the sub-microsecond range, making it suitable for measurement and control systems.","The PTP function requires a time source device and a time receiver device to provide the time synchronization between the devices. The time source is called master and time receiver is known as slave. Apart from this master and slave clock devices, there are intermediate switches in the network through which the packets would be transmitted. On transmitting through these devices, a transmission delay would be introduced on each of the switches placed between the master and the slave. To maintain the accuracy of time synchronization between the master and the slave, it is important to take into consideration these transmit times taken by the PTP frames when passing along the intermediary nodes. The intermediate switches must have the ability to support PTP and thereby update the link and/or residency time of frames in these switches—a concept known as transparent clocking. There are two types of transparent clocks: end-to-end transparent clock and peer-to-peer transparent clock. ","OmniSwitch supports both end-to-end transparent clock and one step peer-to-peer transparent clock.","Enabling/Disabling PTP Time Stamping","The ","interfaces ptp admin-state ","command can be used to enable or disable PTP on all the interfaces.       PTP end-to-end transparent clock is supported in a standalone mode (virtual chassis of one) and virtual chassis of two.","-> interfaces ptp admin-state enable","-> interfaces ptp admin-state disable","The below command sets the internal priority for the incoming PTP packet as 4.","-> interfaces ptp admin-state enable priority 4","To set the internal priority to the default value 5, use the ","default"," keyword.","-> interfaces ptp admin-state enable priority default","To enable PTP end-to-end transparent clock in a virtual chassis of two, single loopback port per chassis is required to be configured. Use ","interfaces ptp admin-state"," command to configure the loopback port. ","The loopback ports dedicated for PTP must not be used by any other feature. Ensure PTP is configured on unused ports. Also, PTP on a virtual chassis of two is not supported on chassis ID 1.","-> interfaces ptp admin-state enable loopback-portlist 2/1/12 3/1/23","WARNING: User ports 2/1/12 and 3/1/23 will be out of service for users.","Enabling/Disabling PTP Peer-to-Peer Transparent Clock","The ","interfaces port ptp p2p"," command can be used to enable or disable IEEE 1588 PTP peer-to-peer transparent clock on an interface. When peer-to-peer is enabled on a port, link delay will be computed dynamically for the corresponding link.","-> interfaces port 1/1/1 ptp p2p admin-state enable","-> interfaces port 1/1/1 ptp p2p admin-state disable","Notes: ","•    ","Ensure Loopback0 IP interface is configured on the switch as loopback0 interface address will be used as the source IP for peer delay measurement packets. If loopback0 IP interface is not configured, then peer delay measurement feature will not work.","•    ","PTP must be enabled globally for PTP peer-to-peer support.","•    ","PTP peer-to-peer supports only one-step mode.","MAC Security Overview","MACsec (MAC Security) provides point-to-point security on Ethernet links between directly connected nodes. MACsec prevents DoS/M-in-M/playback attacks, intrusion, wire-tapping, masquerading, and so on. MACsec can be used to secure traffic on Ethernet links - LLDP frames, LACP frames, DHCP/ARP packets, and so on.","MACsec feature requires a license. The MACsec license is a site license and does not use the serial number and MAC address of the switch. The MACsec license file can be applied using the 'license' command. For more information, refer to the ‘Chassis Management and Monitoring Commands’ chapter in ","OmniSwitch AOS Release 8 CLI Reference Guide",".","How It Works?","MACsec-enabled links are secured by matching security keys. Data integrity checks are done by appending an 8-byte or 16-byte header and a 16-byte tail to all Ethernet frames traversing the secured link. Optionally, traffic can also be encrypted, if enabled by user configuration.","On the wire, a MACsec packet starts with an Ethernet header with etherType 0x88E5, followed by an 8-byte or 16-byte SecTag header containing information about the decryption key, a packet number and Secure Channel Identifier. The SecTag header is followed by the payload (which may be optionally encrypted), and the Integrity Check Value (ICV) generated by GCM-AES of size 16 bytes.","Each node in a MACsec-protected network has at least one transmit secure channel associated with a Secure Channel Identifier (SCI). Configuration parameters such as enable encryption or perform replay protection are stored in the context of the transmit secure channel. A single secure channel is unidirectional - that is, it can be applied to either inbound or outbound traffic.","Figure 1-2 :  MAC Security Overview","Each node that expects to receive traffic sent in a particular transmit secure channel must configure a 'matching' receive secure channel, with an SCI corresponding to the SCI of the transmit secure channel of the peer.","Within each secure channel, secure associations (SA) are defined. The SAs hold the encryption keys identified by their association number (AN), along with a packet number. On the transmit side, this packet number is put in the MACsec SecTag header and used in the encryption process. On the receive side, the packet number from the SecTag header will be checked against the packet number locally stored in the corresponding secure association to perform replay protection.","The default crypto suite used in MACsec is \"128-bit AES-GCM\" and the Session key is called a \"Secure Association Key (SAK)\". Each endpoint in a MACsec-protected network has at least one Tx Secure Channel (SCI-Tx) and multiple Rx Secure Channels (SCI-Rx). Between MACsec secure link, each endpoint point is configured with a matching SCI-Tx and SCI-Rx pair in both direction. Each Secure-Channel (SC) is associated with Secure Associations (SAs), which in turn holds the Secure Association Keys (SAK) along with a Packet Number (PN). ","MACsec supports two SA modes:","•    ","Static SA Mode - MACsec with Static Secure Association Key (static-SAK)","•    ","Dynamic SA Mode - MACsec with Dynamic SAK using MACsec Key Agreement (MKA) Protocol. The MKA, as described in IEEE 802.1X-2010, is an extension to 802.1X, which provides the required session keys and manages the required encryption keys used by the underlying MACsec protocol. The MKA protocol allows peer discovery with confirmation of mutual authentication and sharing of MACsec secret keys to protect data exchanged by the peers. ","There are two modes of provisioning connectivity association keys (CAK/CKN) between two MACsec endpoints. OmniSwitch supports the following:","–    ","Dynamic SAK using Pre-Shared Key (PSK)","MACsec using Static Connectivity Association Key (static-CAK) using PSK ","–    ","Dynamic SAK using Extensible Authentication Protocol (EAP)","MACsec using Dynamic Connectivity Association Key (dynamic-CAK) using EAP.","Static SA Mode ","In static SA mode, manually configured SA keys are used to secure traffic on the point-to-point link between two nodes. ","Consider the following configuration guidelines when MACsec is set to static SA mode:","•    ","The SAK name and value are configured on SCI-Tx and SCI-Rx must be configured on both ends of the MACsec enabled interface. ","•    ","Each SAK name and value must have a corresponding matching value on the interface at the other end of the point-to-point Ethernet link to maintain MACsec on the link.","•    ","Security is maintained by periodically rotating the SA keys between configured SAKs on SCI-Tx.","Dynamic SA Mode","In Dynamic SA Mode, Secure-Channel (SCI-Tx/SCI-Rx) and Secure-Association-Key (SAK) are exchanged between MACsec connected links using MKA protocol. The MKA protocol selects one of the nodes as the key server, which creates a dynamic SAK and shares it with the node at the other end over the secure channel. Once the other end also creates this dynamic SA key, subsequent traffic is secured using the new SA. The key server periodically and randomly creates and exchanges new SA to replace the older SA, using the MKA protocol for as long as the MACsec link is enabled.","Dynamic SAK using Pre-Shared Keys      ","This mode is applicable for securing link between two switch interfaces. Following are some configuration guidelines when MACsec is set to dynamic SA mode:","•    ","Involves explicitly configuring a pre-shared key on a MACsec on both the ends of the point-to-point Ethernet link using a keychain, which triggers the MKA protocol to negotiate and generate necessary key for authentication and encryption.","•    ","Two keys are used to secure the point-to-point Ethernet link.","–    ","A connectivity association key (CAK) that secures control plane traffic. ","–    ","A randomly generated Secure Association Key (SAK) that secures data plane traffic.","•    ","Both keys are exchanged between both the devices on each end of the point-to-point Ethernet link to ensure link security.","•    ","The following action takes place while securing link between two switches using MKA.","–    ","The switches exchange MKPDUs verifying that the CAK/CKN pair match. A MACsec secured link is established using the user configured pre-shared key.","–    ","After the switches have mutually authenticated each other, one of the switches is elected as the key server.","–    ","Both the switches configure a pair of secure channels with matching identifiers.","–    ","Key server switch will then generate a key for each direction. These keys will be used to encrypt and decrypt the actual traffic.","–    ","Secure associations using these keys are configured on both the switches. ","host and switch",".","Dynamic SAK using EAP","This mode is applicable for securing link between a host and a switch end-points. Following are some configuration guidelines when MACsec is set to dynamic SA mode using RADIUS server:","IEEE 802.1X-2010 defines the way that MACsec can be used in conjunction with authentication to provide secure port-based access control using authentication. IEEE 802.1X authenticates the endpoint and transmits the necessary cryptographic keying material to both sides. Using the master keys derived from the IEEE 802.1X authentication, MACsec can establish an encrypted link on the LAN, thereby helping ensure the security of the authenticated session. ","•    ","When configuring MACsec on a switch-to-host link, the MKA session establishment between the switch and the host is initiated once the 802.1x authentication is successful on the port. The 802.1x authentication method must be either EAP-TLS or PEAP authentication framework.","•    ","The MKA keys are received from the RADIUS server. A successful 802.1x-authentication results in MKA keys (MSK and Session-Id), which will be passed from the RADIUS server to the switch and from RADIUS server to the host in an independent authentication transaction. The master key will then be passed between the switch and the host to create a MACsec secured connection. The CAK and CKN is derived from MSK and the EAP session ID. ","•    ","CAK and CKN needs to be derived both at the host and the switch, hence 802.1x-authentication using EAP-TLS must be used as mutual authentication protocol for MACsec Dynamic mode.","After deriving CAK/CKN, the switch acts as the key server. It generates a random SAK, which is sent to the client. The client is never a key server and can only interact with a single MKA entity, the key server. After key derivation and generation, the switch sends periodic transports to the client at a default interval of two seconds.","Key Management and Rotation   ","To support non-interrupting MACsec service, four keys are supported for each secure channel in MACsec Static Mode. One key is used for actively protecting the traffic, while the other keys are programmed into hardware to be used as backup. This would reduce the frequency that SW has to be interrupted to setup a new key. In MACsec Dynamic Mode, the key rotation would be handled in SW using packet number (PN) rollover using MKA protocol.","For more information on security key management commands, see the “Managing System Files” chapter in the ","OmniSwitch AOS Release 8 Switch Management Guide",".","Enabling/Disabling MACsec on an Interface","Use ","interfaces macsec admin-state"," command to enable or disable MACsec on a physical port or a port range. Use this command to,","•    ","Enable or disable MACsec.","Note ","- It is required to install the MACsec license to successfully enable MACsec.","- Only users with MACsec read-write privilege can configure MACsec. Use ‘user’ command to enable MACsec read-write permissions to the users. The privilege can be configured by family or by security domain.","•    ","Set the MACsec mode: Static SA Mode or Dynamic SA Mode","•    ","For Static SA Mode - following configurations can be configured.","–    ","Set the MACsec mode to ‘static’. By default, the MACsec mode is set to ‘static’.","–    ","Create MACsec Tx and Rx channels.","–    ","Specify the SCI value for Tx and Rx channels.","–    ","Associate the keychain ID for Tx and Rx channel. The keychain associated with the SCI-Tx and SCI-Rx must have four keys supporting ‘AES-GCM-128’ algorithm, and the number of keys in the keychain associated with both SCI-Tx and SCI-Rx on an interface must be equal.","–    ","Enable or disable encryption on Tx and Rx channel (optional).","•    ","Dynamic SA Mode has two variations - Dynamic SAK using pre-shared keys and Dynamic SAK using Extensible Authentication Protocol (EAP).","–    ","For Dynamic SAK using pre-shared keys, following configurations can be configured.",">    ","Set the MACsec mode to ‘dynamic’.   ",">    ","Configure the keychain for Static-CAK. The keychain or pre-shared key for Static-CAK must have the key mapped either to ‘AES-CMAC-128’ algorithm or ‘AES-CMAC-256’ algorithm. AES-CMAC-256 option would be supported only on platforms supporting 256-bit key. View ","show interfaces capability"," output to check if the interfaces has the support for MACsec 256-bit encryption.",">    ","Configure key server priority (optional).",">    ","Configure transmit interval for MKPDUs (optional).",">    ","Enable or disable encryption on dynamic secure channel. (optional)","–    ","For Dynamic SAK using EAPs, the following configurations can be configured.",">    ","Set the MACsec mode to ‘radius’.",">    ","Configure transmit interval for MKPDUs (optional).",">    ","Enable or disable encryption on dynamic secure channel (optional).","For example, the following configures MACsec to static mode.","-> interface port 1/1/1 macsec admin-state enable mode static sci-tx 0x1 key-chain 1 encryption sci-rx 0x1 key-chain 1 encryption","The following configures MACsec to dynamic using static CAK.","-> interface port 1/1/1 macsec admin-state enable mode dynamic key-chain 1 server-priority 10 transmit-interval 3","The following configures MACsec to dynamic SAK using EAP.","-> interface port 1/1/1 macsec admin-state enable mode dynamic radius","Use the ","no"," form of this command to disable encryption on Tx/Rx channel, remove keychain configuration on Tx/Rx channel, remove Tx/Rx channel. For example,","-> no interface 1/1/1 macsec sci-rx 0x2 keychain","-> no interface 1/1/1 macsec sci-tx encryption","MKA Protocol Key Exchange Based On Session Time Or Data Exchange","The below configurations are supported to enable MACsec MKA protocol key-rotation:","•    ","Session-Time (in min) for SAK (Secure Association Key) regeneration -    A timer for each MACsec interface will be created for triggering key-rotation when the configured max-session-time is reached.","•    ","   Exchange-Data (received or transmitted) between the MACsec endpoints. -    Key rotation happens when the exchanged data exceeds the configured max-exchange-data. ","Use ","interfaces macsec key-rotation max-session-time"," command to configure the session timer on a single port or a range of ports to perform a Secure Association Key (SAK) re-generation when the session timer gets expired.","The SAK re-generation is performed at the key server side when the session time reaches the configured limit. In addition, the session time on the port is reset to the configured value. The configuration must be configured on both ends of the MACsec enabled interface as either of the sides can be elected as the key server.","For example,","-> interface port 1/1/1 macsec key-rotation max-session-time 20","Use ","interfaces macsec key-rotation max-exchange-data ","command to configure the data exchange on a single port or a range of ports to perform a SAK re-generation each time the limit is reached. This is the data exchanged (received or transmitted) between the MACsec endpoints. ","The SAK re-generation is performed at key server side when the exchanged data reaches the configured value if the key life is less than two minutes. The configuration must be configured on both ends of the MACsec enabled interface as either of the sides can be elected as the key server.","For example,","      -> interface port 1/1/5 macsec key-rotation max-exchange-data 10M","Verifying the MACsec Configuration","To display the MACsec configuration on the switch, use the following ","show"," commands:","show interfaces macsec ","Displays the MACsec configuration on a physical port or port range.","show interfaces macsec static","Displays the detailed MACsec configuration on a physical port or port range configured with MACsec mode ‘Static.","show interfaces macsec dynamic","Displays the detailed MACsec configuration on a physical port or port range configured with MACsec mode ‘Dynamic’.","show interfaces macsec statistics","Displays the MACsec statistics collected for a physical port.","show interfaces macsec dynamic key-rotation","Displays the remaining session time and the exchanged data on the MACsec interfaces.","For more information about the resulting displays from these commands, see the ","OmniSwitch AOS Release 8 CLI Reference Guide","."]],"id":"11"})